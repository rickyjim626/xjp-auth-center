{
  "collectionName": "tokens",
  "description": "Combined access/refresh tokens with session management",
  "indexes": [
    {
      "IndexName": "jti_unique",
      "MgoKeySchema": {
        "MgoIndexKeys": [{"Name": "jti", "Direction": "1"}],
        "MgoIsUnique": true
      }
    },
    {
      "IndexName": "userId_index",
      "MgoKeySchema": {
        "MgoIndexKeys": [{"Name": "userId", "Direction": "1"}],
        "MgoIsUnique": false
      }
    },
    {
      "IndexName": "sessionId_index",
      "MgoKeySchema": {
        "MgoIndexKeys": [{"Name": "sessionId", "Direction": "1"}],
        "MgoIsUnique": false
      }
    },
    {
      "IndexName": "refreshTokenJti_index",
      "MgoKeySchema": {
        "MgoIndexKeys": [{"Name": "refreshTokenJti", "Direction": "1"}],
        "MgoIsUnique": false
      }
    }
  ],
  "fields": [
    {
      "fieldName": "_id",
      "fieldType": "Object",
      "isRequired": true,
      "description": "Auto-generated document ID"
    },
    {
      "fieldName": "jti",
      "fieldType": "String",
      "isRequired": true,
      "description": "JWT ID (unique token identifier)"
    },
    {
      "fieldName": "userId",
      "fieldType": "Object",
      "isRequired": true,
      "description": "Reference to users table"
    },
    {
      "fieldName": "clientId",
      "fieldType": "String",
      "isRequired": true,
      "description": "OAuth client ID"
    },
    {
      "fieldName": "sessionId",
      "fieldType": "String",
      "isRequired": true,
      "description": "Session identifier"
    },
    {
      "fieldName": "tokenType",
      "fieldType": "String",
      "isRequired": true,
      "description": "Token type: access_token or refresh_token"
    },
    {
      "fieldName": "scopes",
      "fieldType": "Array",
      "isRequired": true,
      "description": "Token scopes"
    },
    {
      "fieldName": "refreshTokenJti",
      "fieldType": "String",
      "isRequired": false,
      "description": "Reference to refresh token JTI (for access tokens)"
    },
    {
      "fieldName": "parentRefreshTokenJti",
      "fieldType": "String",
      "isRequired": false,
      "description": "Parent refresh token JTI (for refresh token rotation)"
    },
    {
      "fieldName": "deviceInfo",
      "fieldType": "Object",
      "isRequired": false,
      "description": "Device/client info (userAgent, ip, etc)"
    },
    {
      "fieldName": "expiresAt",
      "fieldType": "Date",
      "isRequired": true,
      "description": "Token expiration time"
    },
    {
      "fieldName": "createdAt",
      "fieldType": "Date",
      "isRequired": true,
      "description": "Token creation timestamp"
    },
    {
      "fieldName": "revokedAt",
      "fieldType": "Date",
      "isRequired": false,
      "description": "Token revocation timestamp"
    },
    {
      "fieldName": "lastUsedAt",
      "fieldType": "Date",
      "isRequired": false,
      "description": "Last token usage timestamp"
    }
  ]
}